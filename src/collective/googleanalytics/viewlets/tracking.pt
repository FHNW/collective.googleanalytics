<tal:tracking condition="view/available">
    <tal:webproperty define="web_property view/getTrackingWebProperty;
                             ga_debug     python:view.debug_mode and 'true' or 'false';"
        condition="web_property">
        <script>
           // Log the data sent to universal analytics 
           function gl(i,s,o,g,r,a,m){
            if (${ga_debug}) {
                 console.log("ga: ",i, ", ",s,", " ,o,", " ,g,", ", r,", ", a,", ", m);
             }
           }

          (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        
          //TODO Remove this:
          ga('create', 'UA-54214879-1', 'auto');
          //ga('create', '${web_property}', 'auto');
          ga('send', 'pageview');
        
        </script>

        <tal:block content="structure view/renderPlugins"></tal:block>
        <script type="text/javascript" tal:content="structure view/renderPageview">
        </script>

    </tal:webproperty>
</tal:tracking>
